## Sistema de Moderación de Ofertas de Trabajo

### 1. Objetivo

Permitir que los usuarios creen **ofertas de trabajo** mediante un comando, que luego pasan por un proceso de **revisión y moderación** antes de hacerse públicas en un canal o foro específico.

Comando: `/oferta crear`.

El flujo básico es:

1. Usuario crea una oferta con un comando.
2. La oferta se envía a un canal de **revisión de ofertas**.
3. Los moderadores deciden: **Aceptar**, **Rechazar** o **Pedir cambios**.
4. Si se acepta, la oferta se publica en el canal / foro público de **Ofertas de Trabajo**.

---

### 2. Roles involucrados

* **Usuario normal**

  * Puede crear ofertas de trabajo mediante un comando.
* **Moderador**

  * Puede revisar y moderar ofertas.
  * Puede aceptar, rechazar o pedir cambios.
* **Bot**

  * Gestiona el flujo completo:

    * Crea el embed de la oferta.
    * Envía la oferta al canal de revisión.
    * Maneja los botones / acciones de moderación.
    * Publica la oferta en el canal público si se aprueba.
    * Notifica al autor de la decisión.

---

### 3. Comando de creación de oferta

`/oferta crear` 

El comando debe:

1. Permitir al usuario **customizar un embed** con campos como:

   * Título del puesto
   * Descripción del rol
   * Requisitos
   * Tipo de trabajo (remoto/presencial/híbrido)
   * Duración (temporal, fijo, freelance, etc.)
   * Rango salarial (si aplica)
   * Método de contacto (DM, email, formulario, etc.)
2. Opcionalmente: permitir campos extra según tu gusto:

   * Etiquetas (`#junior`, `#senior`, `#dev`, etc.)
   * País/horario

3. Renderizar una **previsualización** (embed) antes de enviarla a revisión.

Al finalizar el comando:

* Se genera un objeto interno `<Oferta>` con:

  * ID interno de la oferta
  * Autor (userId)
  * Contenido del embed
  * Estado inicial: `PENDING_REVIEW`
  * Timestamps (creación, última actualización)
* Se envía al canal configurado como **Canal de Revisión de Ofertas**.
* Un usuario solo puede tener **una oferta pendiente de revisión** a la vez.
---

### 4. Canal de revisión de ofertas

Canal: `<Revisión de Ofertas>` (configurable).

Por cada oferta creada:

* El bot envía un **embed** con:

  * Contenido de la oferta tal como el autor la definió.
  * Información adicional:

    * Autor (@usuario)
    * ID de la oferta. IMPORTANTE: podria ser el ID del author para ligar la oferta al usuario.
    * Fecha de creación
* Debajo del embed, el bot agrega **botones de moderación**:

  * `✅ Aceptar`
  * `❎ Rechazar`
  * `✏️ Pedir cambios`


**Reglas:**
* Solo usuarios con permisos de `ManageMessages` pueden usar estos botones.
* Cada oferta solo puede tener **una decisión final**:

  * Una vez aceptada o rechazada, los botones quedan deshabilitados o la notificación se edita para reflejar el estado.

---

### 5. Estados de la oferta

Una oferta tiene al menos estos estados:

* `PENDING_REVIEW`
  Acaba de ser creada, está en el canal de revisión.

* `APPROVED`
  Ha sido aceptada por un moderador y publicada en el canal de ofertas.

* `REJECTED`
  Ha sido denegada por un moderador. No se publica.

* `CHANGES_REQUESTED`
  El moderador pide cambios al autor. La oferta queda en “modo edición”.

* `WITHDRAWN`
  El autor decide retirarla.
  `/oferta retirar` (Nota: No argumento es necesario porque la oferta debe estar ligada al autor).


---

### 6. Acciones de moderación

#### 6.1. Aceptar oferta (`✅ Aceptar`)

Cuando un moderador pulsa **Aceptar**:

1. El bot:

   * Cambia el estado de la oferta a `APPROVED`.
   * Publica la oferta en el canal / foro `<Ofertas de Trabajo>`:

     * Reenvía el embed o genera uno nuevo basado en los datos.
   * Guarda:

     * ID del mensaje público.
     * Canal donde se publicó.
2. Notifica al autor:

   * Por DM o mencionándolo en algún lugar configurable.
   * Mensaje tipo: “Tu oferta ha sido aprobada y publicada en `<Ofertas de Trabajo>`.”

#### 6.2. Rechazar oferta (`❌ Rechazar`)

Cuando un moderador pulsa **Rechazar**:

1. El bot:

   * Cambia el estado a `REJECTED`.
   * Opcional: pide al moderador un motivo (modal, respuesta, etc.).
2. Notifica al autor:

   * Indica que su oferta fue rechazada.
   * Si hay motivo, incluirlo.

No se publica en el canal de ofertas.

#### 6.3. Pedir cambios (`✏️ Pedir cambios`)

Cuando un moderador pulsa **Pedir cambios**:

1. El bot cambia el estado a `CHANGES_REQUESTED`.

2. Se envía un mensaje al autor:

   * Explicando qué cambios se requieren.
   * Puede hacerse por:

     * DM.
     * Respuesta en hilo.
     * Mensaje en un canal específico.

3. Flujo de actualización:

   * El autor puede:

     * Enviar un comando tipo `/actualizar-oferta <id>` con los cambios.
     * O reenviar la oferta con un nuevo comando (y se invalida la anterior).
   * Una vez actualizada, la oferta vuelve a `PENDING_REVIEW` y el flujo se repite.

---

### 7. Canal público de ofertas

Canal/foro: `<Ofertas de Trabajo>` (configurable).

* Solo se publican ofertas con estado `APPROVED`.
* Cada mensaje representa una oferta independiente.
* Opcional:

  * Etiquetas / tags.
  * Auto-thread para preguntas sobre la oferta.
  * Indicar fecha de creación o expiración.

---

### 8. Configuración

El sistema debe permitir configurar, al menos:

* Canal de **Revisión de Ofertas**.
* Canal / foro de **Ofertas de Trabajo**.
* Roles o permisos que cuentan como **moderadores**.
* Opcional:

  * Si se notifica por DM, mención, o ambos.
  * Mensajes plantilla para:

    * Aprobación.
    * Rechazo.
    * Petición de cambios.

---

### 9. Registro / auditoría (opcional pero recomendable)

* Guardar:

  * Qué moderador tomó qué acción sobre qué oferta.
  * Timestamps de cada cambio de estado.
* Útil para:

  * Logs internos.
  * Revisar decisiones antiguas.
  * Evitar abusos.